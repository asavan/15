(function(r,k){function s(a,b,h){var l=b.x-a.x,a=b.y-a.y;return Math.abs(l)+Math.abs(a)<(h||30)?j:Math.abs(l)>Math.abs(a)?0>l?m:n:0>a?o:p}function t(a){var b={};b.x=a.pageX||a.clientX;b.y=a.pageY||a.clientY;return b}function u(a){a.preventDefault();v=a.target.outerText;a=t(a.changedTouches[0]);i.push(a)}function w(a){a.preventDefault();a=a.changedTouches;a=t(a[a.length-1]);a=s(i[0],a);d.bigGo(a,v)&&q();i=[]}function q(){for(var a=0,b;b=h.childNodes[a],16>a;a++){var j=d.getElement(a);b.textContent=
j;b.style.visibility=j?"visible":"hidden"}if(d.isCompleted())h.style.backgroundColor="red",r.removeEventListener("keydown",x),h.removeEventListener("touchstart",u),h.removeEventListener("touchend",w)}for(var m="left",n="right",o="up",p="down",j="none",d=function(){var a={up:-4,left:-1,down:4,right:1},b=[],h=function(f){for(var a=0;16>a;++a)if(b[a]===parseInt(f))return a;return-1},l=function(a){var b={};b.x=a%4;b.y=Math.floor(a/4);return b},d=15,k=function(f){if(!f||f===j)f=!1;else{var e=a[f],f=d+
e;if(0>f||15<f||(e===a.left||e===a.right)&&Math.floor(d/4)!==Math.floor(f/4))f=!1;else{var e=d,c=b[f];b[f]=b[e];b[e]=c;d=f;f=!0}}return f},i=function(){b=[];for(var a=1;16>a;++a)b.push(a);for(var a=b,e=a.length;0<e;){var c=Math.floor(Math.random()*e);e--;var g=a[e];a[e]=a[c];a[c]=g}b.push(0);a=0;e=1;for(c=b.length-1;e<c;e++)for(g=e-1;0<=g;g--)b[g]>b[e]&&++a;a%2&&(a=b[0],b[0]=b[1],b[1]=a)};i();return{reinit:i,go:k,bigGo:function(a,b){var c=h(b),g=l(c),c=h(0),d=l(c),c=d.y-g.y,c=0!==d.x-g.x&&0!==c?j:
s(g,d,1);if(a===c&&c!==j){g=Math.abs(d.x-g.x+d.y-g.y);for(d=0;d<g;++d){var i;i=c===m?n:c===n?m:c===o?p:c===p?o:j;k(i)}return!0}return!1},isCompleted:function(){return!b.some(function(a,b){return 0<a&&a-1!==b})},getElement:function(a){return b[a]}}}(),i=[],v="",h=k.body.appendChild(k.createElement("div")),y=0;16>y;y++)h.appendChild(k.createElement("div"));var x=function(a){d.go({39:"left",37:"right",40:"up",38:"down"}[a.keyCode])&&q()};r.addEventListener("keydown",x);h.addEventListener("touchstart",
u,!1);h.addEventListener("touchend",w,!1);q()})(window,document);